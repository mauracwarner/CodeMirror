<!doctype html>

<title>CodeMirror: Apex mode</title>
<meta charset="utf-8"/>
<link rel=stylesheet href="../../doc/docs.css">

<link rel="stylesheet" href="../../lib/codemirror.css">
<script src="../../lib/codemirror.js"></script>
<script src="../../addon/edit/matchbrackets.js"></script>
<script src="../clike/clike.js"></script>
<script src="./apex.js"></script>
<style>
	.CodeMirror { border: 2px inset #dee; }
    </style>
<div id=nav>
  <a href="http://codemirror.net"><h1>CodeMirror</h1><img id=logo src="../../doc/logo.png"></a>

  <ul>
    <li><a href="../../index.html">Home</a>
    <li><a href="../../doc/manual.html">Manual</a>
    <li><a href="https://github.com/codemirror/codemirror">Code</a>
  </ul>
  <ul>
    <li><a href="../index.html">Language modes</a>
    <li><a class=active href="#"></a>
  </ul>
</div>

<article>
<h2>Apex mode</h2>
<form><textarea id="code" name="code">
@RestResource(urlMapping = '/accounts')
global with sharing class AccountsController {
  private static SoqlService soqlService = new SoqlService();

@HttpGet
global static void getActiveAccountIds() {
    RestContext.response.responseBody = Blob.valueOf(soqlService.getAllActiveAccountIds());
    RestContext.response.statusCode = 200;
  }
}

public class SoqlService {
  public SoqlService() {}

  public List<String> getAllActiveAccountIds() {
    List<Account> accounts = [ SELECT Id FROM Account WHERE IsDeleted = FALSE];
    List<String> accountIds = new List<String>();
    for (Account account : accounts) {
      accountIds.add(account.Id);
    }
    return accountIds;
  }
}

@isTest
public class SoqlServiceTests {
  private static SoqlService service = new SoqlService();

  @isTest static void testGetAllActiveAccountIds() {
      test.startTest();
      Account active = new Account();
      insert active;
      Account inactive = new Account();
      insert inactive;
      delete inactive;

      List<String> output = service.getAllActiveAccountIds();
      System.assert(output.contains(active.Id));
      System.assert(!output.contains(inactive.Id));
      test.stopTest();
  }
}
</textarea></form>

    <script>
      var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
        lineNumbers: true,
        matchBrackets: true,
        mode: "text/x-apex"
      });
    </script>

    <p>A mode for Apex</p>

    <p><strong>MIME types defined:</strong> <code>text/x-apex</code></p>
  </article>
